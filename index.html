<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <!-- CSS -->
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    <!-- CSS Padrão do Leaflet [Necessário] | O leaflet permite utilização de funções no mapa -->
    <link href='https://api.tiles.mapbox.com/mapbox.js/v2.2.4/mapbox.css' rel='stylesheet' />
    <!-- CSS Padrão do Mapbox [Necessário] | O mapbox permite utilização de funções no mapa e define o estilo dele -->
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-label/v0.2.1/leaflet.label.css' rel='stylesheet' />
    <!-- CSS Padrão do Leaflet Label | Permite a criação de labels por hover em cima dos edifícios -->
    <link href='css/style.css' rel='stylesheet' />
    <!-- Nossa folha de estilos personalizada -->
    <link href='css/jquery-ui.min.css' rel='stylesheet' />
    <!-- CSS Padrão do jquery-ui | Utilizamos o jquery-ui para a função de autocomplete -->
    <!-- JS -->
    <script src="js/leaflet.js"></script>
    <!-- JS Padrão do Leaflet [Necessário] -->
    <script src="js/OSMBuildings-Leaflet.js"></script>
    <!-- JS Padrão do OSMBuildings | O OSMBuildings permite a criação de objetos 2.5D com o GeoJSON -->
    <script src='https://api.tiles.mapbox.com/mapbox.js/v2.2.4/mapbox.js'></script>
    <!-- JS Padrão do Mapbox [Necessário] -->
    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-label/v0.2.1/leaflet.label.js'></script>
    <!-- JS Padrão do Leaflet Label -->
    <script src='js/jquery-2.2.1.min.js'></script>
    <!-- JQuery -->
    <script src='js/popups.js'></script>
    <!-- JS contendo o conteúdo de todos os popups dos edifícios -->
    <script src='js/data.js'></script>
    <!-- JS contendo os edifícios em uma única collection de GeoJSON para utilizar o OSMBuildings -->
    <script src='js/data2.js'></script>
    <!-- JS contendo os edifícios em variáveis para criação deles com GeoJSON e implementação do popup. -->
    <script src='js/navigation.js'></script>
    <!-- JS contendo as informações relacionadas à caixa de pesquisa -->
    <script src='js/jquery-ui.min.js'></script>
    <!-- JS Padrão do JQuery UI -->
</head>

<body>
    <div class="wrapper">
        <div id="header">
            <input id="searchBox" placeholder="Buscar por setor, bloco ou sala" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Buscar por setor, bloco ou sala'"><button id="searchMap" type="button" alt="Buscar"><img src="images/search.png"></button>

            <button id="localMap" type="button" alt="Meu local"><img src="images/local.png"></button>
            <ul id="outros">
                <a href="#"><li id="collab">Colaboradores</li></a>
                <a href="#"><li id="helper">Gostaria de colaborar?</li></a>
            </div>

        </div>
        <div id="content">
            <div id="map" style="overflow: hidden; position: absolute; width: 100%; left: 0; height: 100%;"></div>
        </div>
    </div>
    <script>
        //Estilo utilizado para tornar a layer dos edifícios invisível/visível (a layer de edifícios é necessária para que os edifícios sejam clicáveis - isso é referente ao data.js)
        var hidden = {
            "color": "#ffffff",
            "weight": 5,
            "opacity": 0,
            "fillOpacity": 0,
            "fillColor": "#ffffff"
        };
        //Coordenadas salvas em uma variável para limitar a área de visualização do mapa
        var southWest = L.latLng(-7.18384, -34.87593),
            northEast = L.latLng(-7.10379, -34.76658),
            bounds = L.latLngBounds(southWest, northEast);
        //Inicialização do mapa e limitando a área de visualização do mapa com a variável bounds
        L.mapbox.accessToken = 'pk.eyJ1IjoiMTJoYXZlbnNsYXYiLCJhIjoiY2lrcXUzajI4MDA5cHZlbTNoOGs4cHk1byJ9.YKesU01czArkvWBSXzj1iA';
        var map = L.mapbox.map('map', 'mapbox.streets', {
                maxBounds: bounds,
                maxZoom: 25,
                minZoom: 14
            })
            .setView([-7.136664, -34.845972], 15);
        // Código para utilização das tiles do Mapbox
        // (new L.TileLayer('http://otile4.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png', { MAPBOX
            (new L.TileLayer('http://otile1.mqcdn.com/tiles/1.0.0/osm', {
            minZoom: 15
        }, {})).addTo(map);
        //Condição para aplicação do OSMBuildings apenas se o tamanho da tela for maior que o especificado
        // COMENTADO - Condição para omitir OSMBuildings em mobile if ($(window).width() > 850) {         } else {}
            //Adicionar os edifícios 2.5D aos polígonos especificados no data.js
            new OSMBuildings(map).set(data);
        //Isso é um teste do PANNELLUM - Virtual Tour 360º
        var marker = L.marker([-7.136318, -34.845205]).addTo(map);
        marker.bindPopup('<iframe width="700" height="400" allowfullscreen style="border-style:none;" src="http://localhost/pannellum/pannellum.htm?panorama=http://localhost/pannellum/pano2.jpg&amp;title=Montanha&amp;preview=http://localhost/pannellum/panopreview.jpg"></iframe>');
        //Estilo para autopadding dos popups
        var autopad = {
                autoPanPaddingBottomRight: [50, 50],
                autoPanPaddingTopLeft: [50, 120]
            }
            //Adicionar os marcadores transparentes. Eles servem para a função de pesquisa.
        var transIcon = L.Icon.extend({});
        var transmarker = new transIcon({
            iconUrl: 'images/trans.png'
        });
        //Adicionar os edifícios salvos em variáveis no data2.js através do GeoJSON. Cada edifício tem uma variável diferente e, graças a isso, abrirá um popup diferente que está definido no popups.js
        new L.geoJson(CTBlocoJ, {
            style: hidden
        }).bindLabel('Bloco J - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoJ_pop, (autopad));
        new L.geoJson(CAEngenhariaMecanica, {
            style: hidden
        }).bindLabel('CA de Engenharia Mecânica').addTo(map).bindPopup(CAEngenhariaMecanica_pop, (autopad));
        new L.geoJson(CAEngenhariaCivil, {
            style: hidden
        }).bindLabel('CA de Engenharia Civil').addTo(map).bindPopup(CAEngenhariaCivil_pop, (autopad));
        new L.geoJson(LabAnaliseAlimentos, {
            style: hidden
        }).bindLabel('Laboratório de Análise de Alimentos').addTo(map).bindPopup(LabAnaliseAlimentos_pop, (autopad));
        new L.geoJson(LabEficienciaEnergeticaHidraulica, {
            style: hidden
        }).bindLabel('Laboratório de Eficiência Energética e Hidráulica em Saneamento').addTo(map).bindPopup(LabEficienciaEnergeticaHidraulica_pop, (autopad));
        new L.geoJson(CTBlocoA, {
            style: hidden
        }).bindLabel('Bloco A - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoA_pop, (autopad));
        new L.geoJson(CTBlocoB, {
            style: hidden
        }).bindLabel('Bloco B - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoB_pop, (autopad));
        new L.geoJson(CTBlocoC, {
            style: hidden
        }).bindLabel('Bloco C - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoC_pop, (autopad));
        new L.geoJson(CTBlocoD, {
            style: hidden
        }).bindLabel('Bloco D - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoD_pop, (autopad));
        new L.geoJson(CTBlocoE, {
            style: hidden
        }).bindLabel('Bloco E - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoE_pop, (autopad));
        new L.geoJson(CTBlocoFG, {
            style: hidden
        }).bindLabel('Blocos F e G - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoFG_pop, (autopad));
        new L.geoJson(CTBlocoH, {
            style: hidden
        }).bindLabel('Bloco H - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoH_pop, (autopad));
        new L.geoJson(CTBlocoK, {
            style: hidden
        }).bindLabel('Bloco K - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoK_pop, (autopad));
        new L.geoJson(CTBlocoL, {
            style: hidden
        }).bindLabel('Bloco L - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoL_pop, (autopad));
        new L.geoJson(CTBlocoM, {
            style: hidden
        }).bindLabel('Bloco M - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoM_pop, (autopad));
        new L.geoJson(CTBlocoN, {
            style: hidden
        }).bindLabel('Bloco N - Centro de Tecnologia').addTo(map).bindPopup(CTBlocoN_pop, (autopad));
        new L.geoJson(CTBibliotecaSetorial, {
            style: hidden
        }).bindLabel('Biblioteca Setorial - Centro de Tecnologia').addTo(map).bindPopup(CTBibliotecaSetorial_pop, (autopad));
        new L.geoJson(LabEnsaioMateriais, {
            style: hidden
        }).bindLabel('Laboratório de Ensaio de Materiais e Estruturas').addTo(map).bindPopup(LabEnsaioMateriais_pop, (autopad));
        new L.geoJson(LabPPHL, {
            style: hidden
        }).bindLabel('Laboratório PPHL').addTo(map).bindPopup(LabPPHL_pop, (autopad));
        new L.geoJson(PredioEngenhariaEletrica, {
            style: hidden
        }).bindLabel('Prédio de Engenharia Elétrica').addTo(map).bindPopup(PredioEngenhariaEletrica_pop, (autopad));
        new L.geoJson(CTCentroMultimidia, {
            style: hidden
        }).bindLabel('Centro Multimídia - Centro de Tecnologia').addTo(map).bindPopup(CTCentroMultimidia_pop, (autopad));
        new L.geoJson(CTCentroAdministrativo, {
            style: hidden
        }).bindLabel('Centro Administrativo - Centro de Tecnologia').addTo(map).bindPopup(CTCentroAdministrativo_pop, (autopad));
        new L.geoJson(CTAmbienteProfessores, {
            style: hidden
        }).bindLabel('Ambiente dos Professores - Centro de Tecnologia').addTo(map).bindPopup(CTAmbienteProfessores_pop, (autopad));
        new L.geoJson(LabDesativado, {
            style: hidden
        }).bindLabel('Laboratório Desativado - Centro de Tecnologia').addTo(map).bindPopup(LabDesativado_pop, (autopad));
        new L.geoJson(LabFechado, {
            style: hidden
        }).bindLabel('Laboratório Fechado - Centro de Tecnologia').addTo(map).bindPopup(LabFechado_pop, (autopad));
        new L.geoJson(PredioCCHLA, {
            style: hidden
        }).bindLabel('Prédio - CCHLA').addTo(map).bindPopup(PredioCCHLA_pop, (autopad));
        new L.geoJson(CCSABloco1, {
            style: hidden
        }).bindLabel('CCSA - Bloco 1').addTo(map).bindPopup(CCSABloco1_pop, (autopad));
        new L.geoJson(CCSABloco2, {
            style: hidden
        }).bindLabel('CCSA - Bloco 2').addTo(map).bindPopup(CCSABloco2_pop, (autopad));
        new L.geoJson(CAPredio01, {
            style: hidden
        }).bindLabel('CA - Predio 01').addTo(map).bindPopup(CAPredio01_pop, (autopad));
        new L.geoJson(CAPredio02, {
            style: hidden
        }).bindLabel('CA - Predio 02').addTo(map).bindPopup(CAPredio02_pop, (autopad));
         new L.geoJson(CAPredio03, {
            style: hidden
        }).bindLabel('CA - Predio 03').addTo(map).bindPopup(CAPredio03_pop, (autopad));
         new L.geoJson(CAPredio04, {
            style: hidden
        }).bindLabel('CA - Predio 04').addTo(map).bindPopup(CAPredio04_pop, (autopad));
         new L.geoJson(CAPredio05, {
            style: hidden
        }).bindLabel('CA - Predio 05').addTo(map).bindPopup(CAPredio05_pop, (autopad));
         new L.geoJson(CAPredio06, {
            style: hidden
        }).bindLabel('CA - Predio 06').addTo(map).bindPopup(CAPredio06_pop, (autopad));
          new L.geoJson(CAPredio07, {
            style: hidden
        }).bindLabel('CA - Predio 07').addTo(map).bindPopup(CAPredio07_pop, (autopad));
          new L.geoJson(CAPredio08, {
            style: hidden
        }).bindLabel('CA - Predio 08').addTo(map).bindPopup(CAPredio08_pop, (autopad));
          new L.geoJson(CAPredio09, {
            style: hidden
        }).bindLabel('CA - Predio 09').addTo(map).bindPopup(CAPredio09_pop, (autopad));
          new L.geoJson(CCJ, {
            style: hidden
        }).bindLabel('CCJ - Centro de Ciências Jurídicas').addTo(map).bindPopup(CCJ_pop, (autopad));
          new L.geoJson(DEMID, {
            style: hidden
        }).bindLabel('DEMID - Departamento de Mídias Digitais').addTo(map).bindPopup(DEMID_pop, (autopad));
           new L.geoJson(Reitoria, {
            style: hidden
        }).bindLabel('Reitoria').addTo(map).bindPopup(Reitoria_pop, (autopad));
           new L.geoJson(HU, {
            style: hidden
        }).bindLabel('HU - Hospital Universitário').addTo(map).bindPopup(HU_pop, (autopad));
            new L.geoJson(Biblioteca, {
            style: hidden
        }).bindLabel('Biblioteca Central UFPB').addTo(map).bindPopup(Biblioteca_pop, (autopad));
             new L.geoJson(CEBloco1, {
            style: hidden
        }).bindLabel('CE - Bloco 1').addTo(map).bindPopup(CEBloco1_pop, (autopad));
             new L.geoJson(CEBloco2, {
            style: hidden
        }).bindLabel('CE - Bloco 2').addTo(map).bindPopup(CEBloco2_pop, (autopad));
             new L.geoJson(CEBloco3, {
            style: hidden
        }).bindLabel('CE - Bloco 3').addTo(map).bindPopup(CEBloco3_pop, (autopad));
             new L.geoJson(CCEN, {
            style: hidden
        }).bindLabel('CCEN').addTo(map).bindPopup(CCEN_pop, (autopad));
             new L.geoJson(ResidenciaPredio01, {
            style: hidden
        }).bindLabel('Residencia Universitária').addTo(map).bindPopup(ResidenciaPredio1_pop, (autopad));
              new L.geoJson(ResidenciaPredio02, {
            style: hidden
        }).bindLabel('Residencia Universitária').addTo(map).bindPopup(ResidenciaPredio2_pop, (autopad));
    </script>
</body>
</html>